function getPathFromUrl(n){return n.split("?")[0]}function clearChildren(n){while(n.firstChild)n.removeChild(n.firstChild)}function createDiv(n,t){return createElement("div",n,t)}function createButton(n,t){return createElement("button",n,t)}function createElement(n){return document.createElement(n)}function createElement(n,t,i){let r=document.createElement(n);if(t)for(let n of Object.keys(t))r.setAttribute(n,t[n]);return i!==undefined&&i!==null&&(r.innerHTML=i),r}function getParent(n,t){let i=!1;try{let r=n.parentNode;while(r){if(r.classList.contains(t)){i=r;break}r=r.parentNode}}catch(r){}return i}function guid(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){var t=Math.random()*16|0,i=n=="x"?t:t&3|8;return i.toString(16)})}function getElement(n){return document.getElementById(n)}function getValue(n){return document.getElementById(n).value}function getAntiForgeryTokenFromLayout(){return document.getElementsByName("__RequestVerificationToken")[0].value}function getLowerCase(n){return n.toLowerCase().replace(/ğ/gim,"g").replace(/ü/gim,"u").replace(/ş/gim,"s").replace(/ö/gim,"o").replace(/ç/gim,"c").replace(/ /gim,"_").replace(/-/gim,"_")}function createLink(n,t){let i=createElement("a");return i.innerText=n,i.href=t,i}function createButton(n,t){let i=createElement("button");return i.innerText=n,i.onclick=t,i}function hideElement(n){n.style.opacity=0;setTimeout(function(){n.style.display="none"},377)}function showElement(n,t){n.style.opacity=t;setTimeout(function(){n.style.display="block"},89)}function doGet(n,t){let i=new XMLHttpRequest;i.open("GET",n,!0);i.onreadystatechange=function(){i.readyState===XMLHttpRequest.DONE&&(199<i.status&&i.status<300?t(i):i.status!=404&&console.log("error",i.status.toString(),i))};i.send(null)}function doPostWithJsonContent(n,t,i,r){doPostRequest(n,"application/json",t,i,r)}function doPostWithFormUrlEncodedContent(n,t,i,r){doPostRequest(n,"application/x-www-form-urlencoded",t,i,r)}function doPostRequest(n,t,i,r,u){let f=new XMLHttpRequest;f.open("POST",n,!0);f.setRequestHeader("Content-type",t);f.setRequestHeader("RequestVerificationToken",getAntiForgeryTokenFromLayout());f.onreadystatechange=function(){f.readyState===XMLHttpRequest.DONE&&(199<f.status&&f.status<300?r(f):u(f))};f.send(i)}function doIfConfirmed(n,t){showPopup(n.dataset.confirmTitle,n.dataset.confirmContent,!0,t)}function doRedirectIfConfirmedSuccess(n,t){showPopup(n.dataset.confirmTitle,n.dataset.confirmContent,!0,function(){doPostWithFormUrlEncodedContent(n.dataset.url,n.dataset.prm,function(n){let i=JSON.parse(n.response);if(i.isOk===!0)window.location.href=t;else{let n=i.messages.join("<br/>");showPopupMessage(n)}},function(n){let t=JSON.parse(n.response).messages.join("<br/>");showPopupMessage(t)})})}function translateScreen(){translateElement(document.head);translateElement(document.body)}function translateElement(n){if(n!==null&&n!==undefined&&labels!==null&&labels!==undefined){let t="en";currentUser!==undefined&&currentUser!==null&&(t=currentUser.languageIsoCode2Char);let i=n.querySelectorAll("[placeholder]");i.forEach(function(n){for(let i=0;i<labels.length;i++){let r=labels[i];if(r.key===n.placeholder){r.translations.forEach(function(i){if(i.languageIsoCode2===t){n.setAttribute("placeholder",i.translation);return}});break}}});let r=n.querySelectorAll("[data-translation]");r.forEach(function(n){for(let i=0;i<labels.length;i++){let r=labels[i];if(r.key===n.dataset.translation){r.translations.forEach(function(i){if(i.languageIsoCode2===t){n.innerHTML=i.translation;return}});break}}})}}function openTab(n,t){for(var r,u=document.getElementsByClassName("tab-content"),i=0;i<u.length;i++)u[i].style.display="none";for(r=document.getElementsByClassName("tablinks"),i=0;i<r.length;i++)r[i].className=r[i].className.replace("active","");document.getElementById(t).style.display="block";n.currentTarget.className+=" active"}function SecretField(n,t){this.el=n;this.order=t;this.isVisible=!1;this.text=this.el.innerText;this.uniqueId=this.el.parentElement.getAttribute("data-uid")+this.order;this.el.setAttribute("data-id",this.uniqueId);this.getStars=function(n){return"*".repeat(n)};this.getButton=function(n){return"<span class='secretButton' id='"+this.uniqueId+"'>"+n+"<\/span>"};this.getSecretSpan=function(){return"<span class='secretSpan'>"+this.getStars(5)+"<\/span>"};this.enableButtons=function(){var n=document.querySelector('.secretButton[id="'+this.uniqueId+'"]');n.addEventListener("click",()=>{this.isVisible?this.hide():this.show()})};this.hide=function(){this.el.innerHTML=this.getSecretSpan();this.el.innerHTML+=this.getButton("show");this.isVisible=!1;this.enableButtons()};this.show=function(){this.el.innerHTML=this.text;this.el.innerHTML+=this.getButton("hide");this.isVisible=!0;this.enableButtons()}}function hidePopup(){popupContent.innerHTML="";hideElement(popup);hideElement(overlay)}function hidePopupMessage(){popupMessageContent.innerHTML="";hideElement(popupMessage);hideElement(overlayMessage)}function showPopup(n,t,i,r){if(document.querySelector("#popup h1").innerHTML=n,popupContent.innerHTML=t,showElement(popup,1),showElement(overlay,.8),i){let t=createButton("ok",r);t.className="btnGreen";let i=createButton("cancel",hidePopup);i.className="btnRed";let n=createElement("div");n.style.marginTop="13px";n.appendChild(t);n.appendChild(i);popupContent.appendChild(n)}}function showPopupMessage(n){document.querySelector("#popupMessage h1").innerHTML=n;showElement(popupMessage,1);showElement(overlayMessage,.8);let i=createButton("ok",function(){hidePopupMessage();hidePopup()});i.className="btnGreen";let t=createElement("div");t.style.marginTop="13px";t.appendChild(i);popupMessageContent.appendChild(t)}function getSelect(n,t){return t||(t=document),t.querySelector("#select-"+n)}function hasClass(n,t){return(" "+n.className+" ").indexOf(" "+t+" ")>-1}function trimSearchTerm(n,t){let i=t.childNodes;for(let t=0,r=i.length;t<r;t++)if(i[t]&&i[t].innerText&&i[t].innerText.toLowerCase()===n.trim().toLowerCase())return"";return n.trim().toLowerCase().replace(/<br>/g,"").replace(/&nbsp;/g,"")}function onSelectChange(n,t){const i=typeof n=="string"?getSelect(n):n;i.addEventListener("theSelectChange",function(){(typeof n!="string"||n===i.dataset.valueField)&&t(i,i.dataset.value,i.dataset.text)})}function onSelectClear(n,t){let i=typeof n=="string"?getSelect(n):n;i.addEventListener("theSelectClear",function(){(typeof n!="string"||n===i.dataset.valueField)&&t(i,i.dataset.value,i.dataset.text)})}function onSelectInit(n,t){let i=typeof n=="string"?getSelect(n):n;i.addEventListener("theSelectInit",function(){(typeof n!="string"||n===i.dataset.valueField)&&t(i,i.dataset.value,i.dataset.text)})}function createSelectElement(n,t,i,r,u,f,e,o,s,h,c=false,l=20,a,v=false,y=false,p="",w=""){i||(i=["single-select"]);i==="radio-select"&&(i=["radio-select","single-select"]);typeof i=="string"&&(i=[i]);let b=document.createElement("div");if(b.id="select-"+n,b.name="select-"+n,b.dataset.name=n,b.dataset.valueField=n+"Uid",b.dataset.textField=n+"Name",b.dataset.value=u||"",b.dataset.text=f||"",typeof t=="string")b.dataset.url=t;else if(t){const n=`data-json-${guid()}`;b.dataset.url="data-json";b.dataset.json=n;selectDataCache[n]={responseText:JSON.stringify(t)}}return b.dataset.parent=o||"",b.dataset.setFirstItem=e===!0?theTrue:!1,b.dataset.type=r===undefined?"text":r,b.dataset.isIconsVisible=!!c+"",b.dataset.iconFontSize=l+"px",b.dataset.confirmBeforeChange=v,b.dataset.confirmBeforeClear=y,b.dataset.checkForEmptyElementBeforeChange=p,b.dataset.emptyElementPropertyToCheck=w,b.classList.add("select"),b.classList.add(...i),s&&setSingleSelect(b,s),h&&onSelectChange(b,h),a&&onSelectClear(b,a),b}function fillTable(n,t){doGet(n,function(i){if(i!=undefined&&i.responseText!=undefined&&!(i.responseText.length<1)&&!(i.status>299)&&!(i.status<199)){let r=JSON.parse(i.responseText);appendHeader(r.headers,t);r.data.length>0&&(appendRows(r.data,t,n),r.data.length<r.pagingInfo.totalItemCount&&appendPaginationPanel(r.pagingInfo,t));translateElement(t)}})}function appendHeader(n,t){if(!t.firstChild||t.firstChild.tagName!="THEAD"){let i=createElement("tr");if(t.dataset.selectable==="true"){let n=createElement("input");n.type="checkbox";n.onchange=function(){var i=t.lastChild.childNodes;i.forEach(function(t){t.firstChild.firstChild.checked=n.checked})};let r=createElement("th");r.className="selectable";r.appendChild(n);i.appendChild(r)}n.forEach(function(n){let t=createElement("th");t.innerHTML=n.key;t.dataset.translation=n.key;i.appendChild(t)});let r=createElement("thead");r.appendChild(i);t.appendChild(r)}}function prepareRow(n,t){let r=n.split(",_,"),i=document.createElement("tr");if(i.dataset.uid=r[0],t.dataset.selectable==="true"){let t=createElement("input");t.type="checkbox";let n=createElement("td");n.className="selectable";n.appendChild(t);i.appendChild(n)}for(let n=1;n<r.length-1;n++){let f=r[n],u=document.createElement("td"),t=createElement("input");t.type="checkbox";t.disabled="disabled";f.toLowerCase()==="true"?(t.checked="checked",u.appendChild(t)):f.toLowerCase()==="false"?u.appendChild(t):u.innerHTML=f;i.appendChild(u)}return i}function appendRows(n,t){t.firstChild.nextElementSibling&&t.firstChild.nextElementSibling.tagName=="TBODY"&&t.firstChild.nextElementSibling.remove();let i=createElement("tbody");for(let r=0;r<n.length;r++){let u=prepareRow(n[r],t);i.appendChild(u)}t.appendChild(i)}function appendPaginationPanel(n,t){t.parentElement.lastElementChild.classList.contains("pagination")&&t.parentElement.lastElementChild.remove();let i=createElement("div");i.classList="pagination";let u=t.dataset.result,e="&lastUid="+n.lastUid,f="&take="+n.take,r=n.totalItemCount-n.totalItemCount%n.take;r===n.totalItemCount&&(r=(n.totalItemCount/n.take-1)*n.take);let o=r/n.take+1;n.isHavingPrevious&&(appendGotoFirst(i,function(){updateTableRows(u,t)}),appendGotoPrevious(i,function(){updateTableRows(u+"?skip="+(n.skip-n.take)+f+e,t)}));n.type==="page_numbers"&&appendCurrentPage(i,n.currentPage);n.isHavingNext&&appendGotoNext(i,function(){updateTableRows(u+"?skip="+(n.skip+n.take)+f+e,t)});n.type==="page_numbers"&&n.isHavingNext&&appendGotoLast(i,function(){updateTableRows(u+"?skip="+r+f,t)});appendGotoPage(i,function(){var h=i.getElementsByTagName("input")[0];let o=h.value;o<1&&(o=1);let s=(o-1)*n.take;r<=s&&(s=r);updateTableRows(u+"?skip="+s+f+e,t)});appendTotalItemCount(i,n.totalItemCount);t.parentElement.appendChild(i)}function updateTableRows(n,t){doGet(n,function(i){let r=JSON.parse(i.responseText);r.pagingInfo.skip>=r.pagingInfo.totalItemCount||r.data.length===0||(clearChildren(t.lastChild),appendRows(r.data,t,n),t.parentElement.lastChild.remove(),appendPaginationPanel(r.pagingInfo,t))})}function appendGotoFirst(n,t){n.appendChild(createButton("<<",t))}function appendGotoPrevious(n,t){n.appendChild(createButton("<",t))}function appendGotoNext(n,t){n.appendChild(createButton(">",t))}function appendGotoLast(n,t){n.appendChild(createButton(">>",t))}function appendCurrentPage(n,t){let i=createElement("span");i.innerHTML=t;n.appendChild(i)}function appendGotoPage(n,t){let i=createElement("input");i.onkeypress=function(n){n.keyCode===13&&(n.preventDefault(),t())};n.appendChild(i);n.appendChild(createButton("go",t))}function appendTotalItemCount(n,t){var i=createElement("span");i.innerHTML=t+" records";n.appendChild(i)}function handleSelectedRows(n){doIfConfirmed(n,function(){let i=n.parentElement.querySelectorAll("table tbody tr"),t="";if(i.forEach(function(n){let i=n.firstChild,r=i.firstChild;r.checked&&(t+="Uids="+i.parentElement.dataset.uid+"&")}),t.length<1){showPopupMessage("please_select_at_least_one_item");return}doPostWithFormUrlEncodedContent(n.dataset.url,t,function(n){let t=JSON.parse(n.response);if(t.isOk===!0)i.forEach(function(n){let t=n.firstChild,i=t.firstChild;i.checked&&n.remove()}),hidePopup();else{let n=t.messages.join("<br/>");showPopupMessage(n)}},function(n){let t=JSON.parse(n.response);showPopupMessage(t.messages.join("<br/>"))})})}function handleRow(n,t,i,r){doIfConfirmed(n,function(){doPostWithFormUrlEncodedContent(i,t,r,function(n){let t=JSON.parse(n.response);showPopupMessage(t.messages.join("<br/>"))})})}function handleDeleteRow(n,t){let i=n.parentElement.parentElement.dataset.uid;handleRow(n,"id="+i,t,function(t){let i=JSON.parse(t.response);if(i.isOk===!0)n.parentElement.parentElement.remove(),hidePopup();else{let n=i.messages.join("<br/>");showPopupMessage(n)}})}function handlePostAndAppendRow(n){showPopup(n.dataset.confirmTitle,n.dataset.confirmContent,!0,function(){doPostWithFormUrlEncodedContent(n.dataset.url,n.dataset.prm,function(t){let i=JSON.parse(t.response);if(i.isOk===!0){let t=n.nextElementSibling,r=prepareRow(i.item,t);t.lastChild.appendChild(r);hidePopup()}else{let n=i.messages.join("<br/>");showPopupMessage(n)}},function(n){if(n.status==500)showPopupMessage("server_error");else{let t=JSON.parse(n.response).messages;showPopupMessage(t.messages.join("<br/>"))}})})}function handleChangeActivationRow(n,t){let i=n.parentElement.parentElement,e=i.parentElement.parentElement,u=e.firstChild,f=0;for(var r=0;r<u.firstChild.childNodes.length;r++){if(u.firstChild.childNodes[r].dataset.translation==="is_active")break;f++}let o=i.dataset.uid;handleRow(n,"id="+o,t,function(n){let r=JSON.parse(n.response);if(r.isOk===!0){var t=i.children[f];let n=t.children[0].checked,r=n===!0;t.children[0].checked=!r;hidePopup()}else{let t=JSON.parse(n.response);showPopupMessage(t.messages.join("<br/>"))}})}function handleChangeActivationAllRow(n,t){let i=n.parentElement.parentElement,e=i.parentElement.parentElement,u=e.firstChild,f=0;for(var r=0;r<u.firstChild.childNodes.length;r++){if(u.firstChild.childNodes[r].dataset.translation==="is_active")break;f++}let o=i.dataset.uid;handleRow(n,"id="+o,t,function(n){let r=JSON.parse(n.response);if(r.isOk===!0){var t=i.children[f],u=t.children[0],e=i.parentElement.querySelectorAll("input[type=checkbox]");e.forEach(function(n){if(n===u){let n=t.children[0].checked,i=n===!0;t.children[0].checked=!i}else n.checked=!1});hidePopup()}else{let t=JSON.parse(n.response);showPopupMessage(t.messages.join("<br/>"))}})}function handleRestoreRow(n,t,i){var r,o;let u=n.parentElement.parentElement,h=u.parentElement.parentElement,f=h.firstChild,e=0;for(r=0;r<f.firstChild.childNodes.length;r++){if(f.firstChild.childNodes[r].dataset.translation==="revision")break;e++}o=u.children[e].innerText;let s=n.parentElement.parentElement.dataset.uid;handleRow(n,"id="+s+"&revision="+o,t,function(n){let t=JSON.parse(n.response);if(t.isOk===!0)window.location.href=i+"/"+s;else{let n=t.messages.join("<br/>");showPopupMessage(n)}})}function searchWork(){let i=document.getElementById("searchResults"),t=document.getElementById("txtSearch");t.addEventListener("keydown",onUpDownKeyPress);let n=t.value;n!==lastFilter&&(_index=-1,doGet("/Label/SearchData?search="+n,function(n){199<n.status&&n.status<300&&bindLabelSearchDropdown(n.responseText)}));lastFilter=n;n===""?(hide(i),t.removeEventListener("keydown",onUpDownKeyPress)):show(i)}function bindLabelSearchDropdown(n){let t=document.getElementById("searchResults");while(t.childElementCount>1)t.removeChild(t.firstChild);let i=JSON.parse(n);if(i!=null)for(let n=0;n<i.length;n++){let u=i[n],r=document.createElement("a");r.setAttribute("uid",u.uid);r.innerHTML=u.key;t.insertBefore(r,t.firstChild)}}function openLabelSearchListPage(){window.location.href="/Label/SearchList?search="+getLabelSearchTerm()}function openLabelDetailPage(n){window.location.href="/Label/Detail/"+n}function getLabelSearchTerm(){return document.getElementById("txtSearch").value}function show(n){n!=undefined&&n.classList.add("show")}function hide(n){n!=undefined&&n.classList.remove("show")}function onUpDownKeyPress(n){let r=document.getElementById("searchResults"),t=r.getElementsByTagName("a"),i=n.which||n.keyCode;i===KEY.DOWN&&_index<t.length-1?(n.preventDefault(),_index++):i===KEY.UP&&_index>0&&(n.preventDefault(),_index--);markSelected(t,_index);i===KEY.ENTER&&(_index===t.length-1?openLabelSearchListPage():openLabelDetailPage(t[_index].getAttribute("uid")))}function markSelected(n,t){if(n.length!==1)for(let i=0;i<n.length;i++){let r=n[i];i===t?r.classList.add("list-item-selected"):r.classList.remove("list-item-selected")}}let currentUser=null;doGet("/Data/GetCurrentUser",function(n){199<n.status&&n.status<300&&(n.status===200&&n.responseText!==null?(localStorage.setItem("currentUser",n.responseText),currentUser=JSON.parse(localStorage.getItem("currentUser"))):n.status===200&&n.responseText===null?(currentUser=null,window.redirect("/Login")):n.status===500&&(localStorage.clear(),window.redirect("/Login")))});let labels=JSON.parse(localStorage.getItem("labels"));labels==null||labels.length===0?doGet("/Data/GetMainLabels",function(n){199<n.status&&n.status<300&&(labels=localStorage.setItem("labels",n.responseText),translateScreen())}):translateScreen();let overlay=getElement("overlay"),overlayMessage=getElement("overlayMessage"),popup=getElement("popup"),popupContent=getElement("popupContent"),popupMessage=getElement("popupMessage"),popupMessageContent=getElement("popupMessageContent");if(document.getElementById("overlay")){var popupOverlay=document.getElementById("overlay");popupOverlay.onclick=function(){hidePopup()}}let theSelectChangeEvent=new Event("theSelectChange",{bubbles:!0});let theSelectClearEvent=new Event("theSelectClear"),theSelectInitEvent=new Event("theSelectInit");theSelectInitEvent=new Event("theSelectInit");let urlArray=[];setInterval(function(){urlArray=[]},13e3);let theTrue="True",theValueSeparator=",",refreshSelect=()=>{},initSelects=()=>{},initSingleSelect=()=>{},setSingleSelect=()=>{},resetSingleSelect=()=>{},initSelectContentFromJson=()=>{},clearSelect=()=>{},clearSelectContent=()=>{},clearMultipleSelectContent=()=>{},selectDataCache={},onChangeSelect=()=>{},onClearSelect=()=>{},resetSelectWithoutCloning=()=>{};(function(){function f(n,t){let i=[];t!==undefined&&(i=JSON.parse(t.responseText));hasClass(n,"radio-select")?initRadioSelect(n,i):hasClass(n,"single-select")?initSingleSelect(n,i):hasClass(n,"multiple-select")&&g(n,i)}function l(i){let u=getParent(i,"ra-settings-wrapper"),r=i.closest(".select");if(hasClass(r,"show"))r.classList.remove("show"),u&&(u.style.overflow="hidden");else if(!hasClass(r,"disabled")){r.classList.add("show");u&&(u.style.overflow="initial");let f="";if(r.dataset.parent!==""&&r.dataset.parent!==undefined){let n=getSelect(r.dataset.parent);n!==undefined&&n!==null&&n.dataset.value!==undefined&&(f=n.dataset.value)}let e="",i=r.lastElementChild.childElementCount;r.lastElementChild.childNodes!==undefined&&r.lastElementChild.childNodes[i]!==undefined&&i>0&&(e=r.lastElementChild.childNodes[i].getAttribute("value"));let s=r.dataset.url;s&&t(r,s+"?take="+n+"&parent="+f+"&lastUid="+e,function(n){let t=JSON.parse(n.responseText);o(r,t)})}}function e(n,t,i,r){let f=r.querySelector("#"+r.dataset.textField).getAttribute("value");if(f&&f.indexOf(t.text)>=0)return null;let e=n.childNodes;for(let n=0,i=e.length;n<i;n++)if(e[n].innerHTML===t.text)return null;let u=createElement("div");if(u.className="select-item",i==="content"){u.classList.add("content-item");let n=createElement("img");n.className="select-item-image";n.setAttribute("src",t.image);let i=createElement("label");i.className="select-item-text";i.innerHTML=t.text;u.appendChild(n);u.appendChild(i)}else u.innerHTML=t.text,u.setAttribute("title",t.text);return u.setAttribute("value",t.value),n.appendChild(u),u}function p(i,r){const u=document.querySelectorAll(`.select[data-parent='${r}']`);u.forEach(function(u){if(u.dataset.parent===r){let e=u.dataset.url+"?take="+n+"&parent="+i;urlArray.includes(e)||urlArray.push(e);let o=u;t(u,e,function(n){u.innerHTML="";u.dataset.text="";u.dataset.value="";f(o,n)})}})}function a(r){if(r.offsetHeight+r.scrollTop>=r.scrollHeight){let u=r.closest(".select"),h=u.dataset.parent,l=trimSearchTerm(u.querySelector(".select-button-input").innerHTML,r),o=r.querySelectorAll(".select-item"),a=o.length,c=u.dataset.url;if(!c)return;let f=c+"?q="+l+"&take="+n;if(o.length>0){let n=o[a-1].getAttribute("value");f+="&lastUid="+n}if(h){let n=getSelect(h);n!==undefined&&(f+="&parent="+n.dataset.value)}urlArray.includes(f)||(urlArray.push(f),t(u,f,function(n){let t=JSON.parse(n.responseText),f=u.dataset.type;for(let n=0;n<t.length;n++){let o=e(r,t[n],f,u);o!==null&&(o.onclick=function(){hasClass(u,"single-select")?i(this):s(this)})}}))}}function o(n,t){let r=n.querySelector(".select-content");if(t.length===0&&r.childElementCount===0){r.innerHTML=" ";let n=createElement("div");n.style.padding="5px";n.style.color="grey";n.innerHTML="no_item";n.dataset.translation="no_item";r.appendChild(n)}for(let u=0;u<t.length;u++){let f=e(r,t[u],n.dataset.type,n);f!==null&&(f.onclick=function(){hasClass(n,"single-select")?i(this):hasClass(n,"multiple-select")&&s(this)})}h()}function v(i,u){let f=i.closest(".select"),h=f.querySelector(".select-button"),v=f.querySelector(".select-content"),l=f.dataset.parent,a=trimSearchTerm(i.innerHTML,v);if((r.length!==0||u.keyCode!==8)&&u.keyCode!==38&&u.keyCode!==40&&u.keyCode!==13&&a.length!==1){if(r===i.innerHTML){c=!0;return}r=i.innerHTML;c=!1;f.querySelector(".loader")&&f.querySelector(".loader").remove();let s=createElement("div");s.className="loader";s.style.right="-30px";h.insertBefore(s,h.firstChild);let e=f.dataset.url+"?q="+a+"&take="+n;if(l){let n=getSelect("select-"+l);n!==undefined&&n.dataset.value!==undefined&&(e+="&parent="+n.dataset.value)}urlArray.includes(e)||(urlArray.push(e),t(f,e,function(n){let t=JSON.parse(n.responseText);f.querySelector(".loader")&&f.querySelector(".loader").remove();rt(f);o(f,t)}))}}function w(n,t){let i=createElement("div");i.className="select-button";let f=createElement("input");f.setAttribute("type","hidden");f.id=n.dataset.valueField;f.name=n.dataset.valueField;let e=createElement("input");e.setAttribute("type","hidden");e.id=n.dataset.textField;e.name=n.dataset.textField;let u=createElement("div");u.className="select-button-input";u.setAttribute("contenteditable",theTrue);let o=createButton("X",ut);if(o.className="clear-select-button",i.innerHTML="",i.appendChild(f),i.appendChild(e),i.appendChild(u),i.appendChild(o),n.appendChild(i),t===undefined&&n.dataset.value===""){i.classList.add("disabled");return}hasClass(i,"disabled")&&i.classList.remove("disabled");n.dataset.value!==""&&n.dataset.text!==""?(u.innerHTML=n.dataset.text,f.value=n.dataset.value,e.value=n.dataset.text):n.dataset.setFirstItem===theTrue&&setSingleSelect(n);i.onclick=function(){l(this)};u.onkeydown=function(n){let t=this.closest(".select");if(t.classList.contains("disabled"))n.preventDefault();else if(t.classList.add("show"),r=this.innerHTML,n.keyCode===13)return document.execCommand("insertHTML",!1,""),!1};u.onkeyup=function(t){t.preventDefault();n.classList.contains("disabled")||v(this,t)}}function b(n){let i=createElement("button");i.className="select-item-info-btn";i.innerHTML="i";n.querySelector(".select-button").appendChild(i);let t=createElement("div");t.className="select-info-wrapper";let r=createElement("button");r.className="close-popover-btn";r.innerHTML="x";t.appendChild(r);r.onclick=function(){t.classList.remove("show")};let u=createElement("div");u.className="select-info-header";let f=createElement("img");f.className="select-info-img";let e=createElement("label");e.className="select-info-title";u.appendChild(f);u.appendChild(e);let o=createElement("div");o.className="select-info-desc";t.appendChild(u);t.appendChild(o);n.appendChild(t);i.onmouseover=function(){let i=n.querySelector(".select-button-input").innerHTML.toLowerCase();i&&(t.classList.add("show"),f.setAttribute("src","url"),e.innerHTML="select item text")};i.onclick=function(n){n.preventDefault();n.stopPropagation();t.classList.remove("show");let i='<div class="select-item-header">';i+='<img class="select-item-image" src="Sample">';i+='<label class="select-item-text">sample text<\/label>';i+="<\/div>";showPopup("Detail",i,!0,function(){})}}function k(n,t){let r=createElement("div");if(r.className="select-content",t!==undefined)for(let u=0;u<t.length;u++){let f=e(r,t[u],n.dataset.type,n);f!==null&&(f.onclick=function(){i(this)})}n.appendChild(r);r.onscroll=function(){a(this)}}function d(n,t,i){const r=createDiv({"class":"confirm-popup","data-translate":"are_you_sure_to_change_the_value"},"are_you_sure_to_change_the_value");n.querySelector(".confirm-popup")||n.appendChild(r);const u=createDiv({"class":"confirm-popup-buttons"}),f=createElement("button",{"class":"red","data-translate":"change"},"change"),e=createElement("button",{"class":"green","data-translate":"cancel"},"cancel");u.appendChild(f);u.appendChild(e);r.appendChild(u);f.addEventListener("click",()=>{r.remove(),onChangeSelect(n,t,i)});e.addEventListener("click",()=>{r.remove()})}function i(n,t){let i=n.closest(".select"),r="";if(i.dataset.checkForEmptyElementBeforeChange){const n=document.querySelectorAll(i.dataset.checkForEmptyElementBeforeChange),t=i.dataset.emptyElementPropertyToCheck?i.dataset.emptyElementPropertyToCheck:"textContent";if(n&&n.length)for(const n of n)r+=n[t]}i.dataset.confirmBeforeChange==="true"&&i.dataset.value!==""&&r!==""?d(i,n,t):onChangeSelect(i,n,t)}function g(n,t){nt(n);tt(n,t)}function nt(n){let t=createElement("div");t.className="select-button";let i=createElement("div");i.className="select-button-input";i.setAttribute("contenteditable",theTrue);t.appendChild(i);let u=createElement("input");u.setAttribute("type","hidden");u.id=n.dataset.valueField;u.name=n.dataset.valueField;u.value=n.dataset.value;let f=createElement("input");if(f.setAttribute("type","hidden"),f.id=n.dataset.textField,f.name=n.dataset.textField,f.value=n.dataset.text,t.appendChild(u),t.appendChild(f),n.appendChild(t),n.dataset.value!==""){let r=n.dataset.value.split(theValueSeparator),u=n.dataset.text.split(theValueSeparator);u.forEach(function(u,f){let e=createElement("div");e.className="active-item";e.setAttribute("draggable",theTrue);e.setAttribute("data-value",r[f]);let o=createElement("span");o.innerHTML=u;e.id=n.dataset.valueField+"-"+o.innerHTML;let s=createButton("X",y);s.className="remove-active-item";e.appendChild(o);e.appendChild(s);t.insertBefore(e,i)})}t.onclick=function(){l(this)};i.onkeydown=function(n){let t=this.closest(".select");if(t.classList.add("show"),r=this.innerHTML,n.keyCode===13)return document.execCommand("insertHTML",!1,""),!1;if(!this.innerHTML&&n.keyCode===8){let n=this.previousSibling;if(n&&n.className==="active-item"){let r=n.querySelector("span").innerHTML;n.remove();let u=t.dataset.type,i=t.querySelectorAll(".select-item");for(let n=0;n<i.length;n++)hasClass(i[n],"active")&&(u==="content"&&i[n].querySelector(".select-item-text").innerHTML===r?i[n].classList.remove("active"):i[n].innerHTML===r&&i[n].classList.remove("active"))}}};i.onkeyup=function(n){n.preventDefault();v(this,n)}}function tt(n,t){let r=n.dataset.type,i=createElement("div");i.className="select-content";for(let u=0;u<t.length;u++){let f=e(i,t[u],r,n);f!==null&&(f.onmouseover=function(){let n=i.querySelectorAll(".select-item");for(let t=0;t<n.length;t++)hasClass(n[t],"hover")&&n[t].classList.remove("hover");this.classList.add("hover")},f.onclick=function(){s(this)})}n.appendChild(i);i.onscroll=function(){a(i)}}function s(n){n.classList.add("active");let i=n.closest(".select"),u=i.querySelector(".select-button"),e=u.querySelector(".select-button-input"),t=createElement("div");t.className="active-item";t.setAttribute("draggable",theTrue);let r=createElement("span");r.innerHTML=i.dataset.type==="content"?n.querySelector(".select-item-text").innerHTML:n.innerHTML;t.id=i.dataset.valueField+"-"+r.innerHTML;t.value=n.getAttribute("value");let f=createButton("X",y);f.className="remove-active-item";t.appendChild(r);t.appendChild(f);u.insertBefore(t,e);let o=n.getAttribute("value"),s=n.innerText;it(i,o,s);h()}function h(){const n=document.querySelector(".select-content"),t=document.querySelector(".custom-select");n.style.top=t.offsetHeight-2+"px";console.log("inside initSelectItems",n)}function it(n,t,i){let r=getElement(n.dataset.valueField).getAttribute("value");r!==null&&r!==undefined&&r!==""&&(t=r+theValueSeparator+t);let u=getElement(n.dataset.textField).getAttribute("value");u!==null&&u!==undefined&&u!==""&&(i=u+theValueSeparator+i);getElement(n.dataset.valueField).setAttribute("value",t);getElement(n.dataset.textField).setAttribute("value",i)}function y(n){n.preventDefault();n.stopPropagation();let t=this.closest(".select"),r=this.closest(".active-item"),u=r.querySelector("span").innerHTML,f=r.value,e=getElement(t.dataset.textField).getAttribute("value"),o=getElement(t.dataset.valueField).getAttribute("value");getElement(t.dataset.valueField).setAttribute("value",o.replace(f,""));getElement(t.dataset.textField).setAttribute("value",e.replace(u,""));r.remove();let i=t.querySelectorAll(".select-item");for(let n=0;n<i.length;n++)hasClass(i[n],"active")&&(t.dataset.type==="content"&&i[n].querySelector(".select-item-text").innerHTML===u?i[n].classList.remove("active"):i[n].innerHTML===u&&i[n].classList.remove("active"));h()}function rt(n){let t=n.querySelector(".select-content");t.innerHTML=""}function ut(n){n.preventDefault();n.stopPropagation();const t=n.target.closest(".select");t.classList.contains("disabled")||clearSelect(t)}function ft(n){const t=createDiv({"class":"confirm-popup","data-translate":"are_you_sure_to_clear_this_field"},"are_you_sure_to_clear_this_field");n.querySelector(".confirm-popup")||n.appendChild(t);const i=createDiv({"class":"confirm-popup-buttons"}),r=createElement("button",{"class":"red","data-translate":"delete"},"clear"),u=createElement("button",{"class":"green","data-translate":"cancel"},"cancel");i.appendChild(r);i.appendChild(u);t.appendChild(i);r.addEventListener("click",()=>{t.remove(),onClearSelect(n)});u.addEventListener("click",()=>{t.remove()})}let n=100,r="",c=!1,u=document.querySelectorAll("div.select");refreshSelect=function(i,r){hasClass(i,"radio-select")?i.dataset.setFirstItem===theTrue&&t(i,i.dataset.url+"?take="+n,function(n){f(i,n);r&&r()}):i.dataset.value===""&&i.dataset.text===""&&i.dataset.setFirstItem===theTrue?t(i,i.dataset.url+"?take="+n,function(n){f(i,n);r&&r()}):(f(i),r&&r())};setSingleSelect=function(r,u,f){r.dataset.value!==u&&r.dataset.url&&r.dataset.url!=="undefined"&&t(r,r.dataset.url+"?take="+n,function(n){const e=JSON.parse(n.responseText);o(r,e);const t=r.querySelector('[value="'+u+'"]');if(t)i(t,f);else if(r.dataset.setFirstItem===theTrue){const n=r.querySelectorAll(".select-content [value]")[0];n&&i(n,f)}else clearSelect(r)})};resetSingleSelect=function(n){n.dataset.value="";n.dataset.text="";n.removeAttribute("data-is-valid");let t=n.cloneNode(!1);return n.parentNode.replaceChild(t,n),t};initSingleSelect=function(n,t){return new Promise(i=>{hasClass(n,"radio-select")||n.querySelector("div.select-button")!==null||(w(n,t),n.dataset.detail===theTrue&&b(n,n.dataset.detailUrl),k(n,t),i(1))})};onChangeSelect=(n,t,i)=>{let u=t.getAttribute("value"),r=t.innerHTML;n.dataset.type==="content"?(r=t.querySelector(".select-item-text").innerHTML,n.querySelector(".select-button-input").innerHTML=r):n.querySelector(".select-button-input").innerHTML=r;n.querySelector("#"+n.dataset.valueField).setAttribute("value",u);n.querySelector("#"+n.dataset.textField).setAttribute("value",r);n.dataset.value=u;n.dataset.text=r;p(u,n.dataset.name);i||n.dispatchEvent(theSelectChangeEvent);n.classList.remove("show")};clearSelect=n=>{n.dataset.confirmBeforeClear==="true"&&n.dataset.value!==""?ft(n):onClearSelect(n)};onClearSelect=t=>{let f=t.querySelector(".select-button");if(f){let e=f.querySelector(".select-button-input");e.innerHTML="";t.dataset.value="";t.dataset.text="";getElement(t.dataset.valueField).value="";getElement(t.dataset.textField).value="";let i,s=t.dataset.valueField;if(u.forEach(function(n){if(n.dataset.valueField===t.dataset.parent&&(i=getElement(t.dataset.valueField).getAttribute("value")),n.dataset.parent===s)if(hasClass(n,"radio-select"))n.querySelector(".select-radio-items").innerHTML=" ";else{let t=n.querySelector(".select-button");t&&(n.querySelector(".select-button-input").innerHTML="",n.querySelector(".select-content").innerHTML="",n.dataset.value="",n.dataset.text="")}}),!t.classList.contains("disabled")){let r=t.dataset.url+"?q=&take="+n;i!==undefined&&(r+="&parent="+i);urlArray.includes(r)||doGet(r,function(n){let i=JSON.parse(n.responseText);o(t,i)});t.dispatchEvent(theSelectClearEvent)}}};clearMultipleSelectContent=n=>{let t=n.querySelector(`#${n.dataset.valueField}`),i=n.querySelector(`#${n.dataset.textField}`);t&&(t.value="");i&&(i.value="");let r=n.querySelectorAll(".remove-active-item");r.forEach(function(n){n.click()})};document.addEventListener("click",function(n){let i=document.querySelectorAll(".select.show");i.forEach(t=>{t!==getParent(n.target,"select")&&t.classList.remove("show")});let t=document.querySelector(".select-info-wrapper.show");t&&t.contains(n.target)===!1&&t.classList.remove("show")});document.addEventListener("keyup",function(n){u=document.querySelectorAll("div.select");let f;for(let n=0;n<u.length;n++)hasClass(u[n],"show")&&(f=u[n]);let e,t,r=-1;if(f){e=f.querySelector(".select-content");t=e.querySelectorAll(".select-item");for(let n=0;n<t.length;n++)hasClass(t[n],"hover")&&(r=n);n.keyCode===38&&(n.preventDefault(),r-1>=0&&(e.scrollTop-=t[r].offsetHeight,t[r].classList.remove("hover"),t[r-1].classList.add("hover")));n.keyCode===40&&(n.preventDefault(),r+1<t.length&&(r===-1?t[r+1].classList.add("hover"):(e.scrollTop+=t[r].offsetHeight,t[r].classList.remove("hover"),t[r+1].classList.add("hover"))));n.keyCode===13&&t[r]&&hasClass(t[r],"active")===!1&&c===!1&&(hasClass(f,"single-select")?i(t[r]):hasClass(f,"multiple-select")&&s(t[r]))}},!1);const t=(n,t,i)=>{selectDataCache[t]?setTimeout(()=>{i(selectDataCache[t])},4):n.dataset.json?i(selectDataCache[n.dataset.json]):doGet(t,n=>{selectDataCache[t]=n,i(n)})};initSelects=function(){document.querySelectorAll("div.select").forEach(function(n){refreshSelect(n,()=>{n.dataset.is_init_done="true",n.dispatchEvent(theSelectInitEvent)})})};initSelectContentFromJson=function(n,t){const i=`data-json-${guid()}`;n.dataset.url="data-json";n.dataset.json=i;window.selectDataCache[i]={responseText:JSON.stringify(t)};refreshSelect(n)};resetSelectWithoutCloning=function(n){return n.dataset.value="",n.dataset.text="",clearChildren(n),n};window.addEventListener("resize",h);initSelects()})();let tables=document.querySelectorAll("table");tables.forEach(function(n){n.dataset.result!=undefined&&fillTable(n.dataset.result,n)});let _index=-1,lastFilter="";document.onclick=function(n){let t=n.target;if(t.id!=="searchResults"||t.id!=="txtSearch"){let n=document.getElementById("searchResults");hide(n)}};let KEY={UP:38,DOWN:40,ENTER:13};